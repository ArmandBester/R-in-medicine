ARVs_on_infection %>%
na.omit() %>%
ggplot(aes(x = PersCov, y = estimate, shape = p.Interpreted, color = NumberInfected))+
geom_point()+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()+
xlab("% ARV coverage") + ylab("Extimated change in HIV infection (people/year)")
new_infections_2017 %>%
left_join(arv_dat, by = "Country") %>%
select(c(1,9,10))
new_infections %>%
left_join(arv_dat, by = "Country") %>%
select(c(1,9,10))
new_infections %>%
left_join(arv_dat, by = "Country") %>%
select(c(1,9,10)) %>%
ggplot(aes(x = PersCov, y = 2017))+
geom_point()
new_infections %>%
left_join(arv_dat, by = "Country") %>%
select(c(1,9,10)) %>%
ggplot(aes(x = PersCov, y = '2017'))+
geom_point()
new_infections %>%
left_join(arv_dat, by = "Country") %>%
select(c(1,9,10)) %>%
ggplot(aes(x = PersCov, y = new_infections$`2017`))+
geom_point()
View(ARVs_on_infection)
View(rates_modeled)
View(arv_dat)
View(ARVs_on_infection)
View(hiv_mort)
View(new_infections)
View(rates_modeled)
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
select(c(1,2)) %>%
left_join(arv_dat, by = Country)
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
select(c(1,2)) %>%
left_join(arv_dat, by = "Country")
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
select(c(1,2)) %>%
left_join(arv_dat, by = "Country")
View(inc_vs_arv)
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2)) %>%
left_join(arv_dat, by = "Country")
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2)) %>%
left_join(arv_dat, by = "Country") %>%
mutate_at(2, clean_deaths())
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2)) %>%
left_join(arv_dat, by = "Country") %>%
mutate_at(2, clean_deaths)
View(inc_vs_arv)
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2)) %>%
left_join(arv_dat, by = "Country") %>%
mutate_at(2, clean_deaths) %>%
na.omit()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = `2017_Prev`))+
geom_point()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = `2017_Prev`,label = Country))+
geom_point()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = `2017_Prev`,label = Country))+
geom_point()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = `2017_Prev`, annotate = Country))+
geom_point()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = `2017_Prev`, text = Country))+
geom_point()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = `2017_Prev`, text = Country))+
geom_point()+
geom_text_repel(aes(label = Country), size = 3)+
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = `2017_Prev`, text = Country))+
geom_point()+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = `2017_Prev`, text = Country))+
geom_point()+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = `2017_Prev`, size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2,3)) %>%
left_join(arv_dat, by = "Country") %>%
mutate_at(c(2,3), clean_deaths) %>%
na.omit()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = (`2017_Prev` - `2010_Prev`), size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = (`2017_Prev` - `2005_Prev`), size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2,4)) %>%
left_join(arv_dat, by = "Country") %>%
mutate_at(c(2,3), clean_deaths) %>%
na.omit()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = (`2017_Prev` - `2005_Prev`), size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2,5)) %>%
left_join(arv_dat, by = "Country") %>%
mutate_at(c(2,3), clean_deaths) %>%
na.omit()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = (`2017_Prev` - `2000_Prev`), size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
View(inc_vs_arv)
inc_delta_vs_arv <- read_csv("share-of-the-population-infected-with-hiv.csv",
col_names = c("Country", "Code", "Year", "PercPop")) %>%
filter(Country %in% sub_sahara) %>%
select(c(-2)) %>%
left_join(arv_dat, by = "Country") %>%
na.omit()
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(maptools)
library(viridis)
library(RColorBrewer)
library(mapproj)
library(broom)
library(ggrepel)
#library(sf)
})
hiv_mort <-
read_csv("HIV deaths.csv", col_types = "ccccc") %>%
na_if("No data") %>%
mutate_at(vars(starts_with("Deaths")), clean_deaths) %>%
filter(Country %in% sub_sahara)
# A list of Sub-Saharan countries
sub_sahara <- readLines("Sub-Saharan.txt")
clean_deaths <- function(x){
# Remove the ranges in brackets and convert the values to integers
x %>%
str_replace_all("\\[.*?\\]", "") %>%
str_replace_all("<", "") %>%
str_replace_all(" ", "") %>%
as.numeric()
}
arv_dat <- arv_dat %>%
filter(Country %in% sub_sahara) %>%
na_if("No data") %>%
mutate_at(2:4, clean_deaths)
# Read csv with ARV infection dat
arv_dat <- read_csv(
"ARV cov 2017.csv",
col_types = "cccc",
col_names = c("Country", "PersCov", "NumberOnARV", "NumberInfected"),
skip = 1
)
head(arv_dat)
# A list of Sub-Saharan countries
sub_sahara <- readLines("Sub-Saharan.txt")
clean_deaths <- function(x){
# Remove the ranges in brackets and convert the values to integers
x %>%
str_replace_all("\\[.*?\\]", "") %>%
str_replace_all("<", "") %>%
str_replace_all(" ", "") %>%
as.numeric()
}
arv_dat <- arv_dat %>%
filter(Country %in% sub_sahara) %>%
na_if("No data") %>%
mutate_at(2:4, clean_deaths)
head(arv_dat)
arv_dat %>%
top_n(4, wt = NumberInfected) %>%
arrange(-NumberInfected) %>%
kable(format = "html", caption = "Countries with the highest number of HIV infections") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
arv_dat %>%
na.omit(PersCov) %>%
ggplot(aes(x = reorder(Country, PersCov), y = PersCov)) +
geom_point(aes(colour = NumberInfected), size = 3) +
scale_colour_viridis(name = "Number of people infected", trans = "log10") +
coord_flip() +
ylab("% ARV coverage") + xlab("Country") +
theme_bw()
hiv_mort <-
read_csv("HIV deaths.csv", col_types = "ccccc") %>%
na_if("No data") %>%
mutate_at(vars(starts_with("Deaths")), clean_deaths) %>%
filter(Country %in% sub_sahara)
head(hiv_mort)
hiv_mort <-
read_csv("HIV deaths.csv", col_types = "ccccc") %>%
na_if("No data") %>%
mutate_at(vars(starts_with("Deaths")), clean_deaths) %>%
filter(Country %in% sub_sahara)
head(hiv_mort)
summary(hiv_mort)
hiv_mort <- hiv_mort %>%
mutate(
min = apply(hiv_mort[, 2:4], 1, FUN = min),
max  = apply(hiv_mort[, 2:4], 1, FUN = max),
Change = max - min
)
hiv_mort %>%
top_n(10, wt = Change) %>%
gather(Year, Deaths, Deaths_2017:Deaths_2000) %>%
na.omit() %>%
mutate(
Year = str_replace(Year, "Deaths_", "") %>% as.numeric()
) %>%
ggplot(aes(x = Year, y = Deaths, color = Country)) +
geom_line() +
geom_vline(xintercept = 2004, color = "black", linetype = "dotted") +
theme_bw() +
theme(legend.position = "bottom")
hiv_mort <- hiv_mort %>%
mutate(
min = apply(hiv_mort[, 2:4], 1, FUN = min),
max  = apply(hiv_mort[, 2:4], 1, FUN = max),
Change = max - min
)
rates_modeled <- new_infections %>%
na.omit() %>%
gather(Year, NewInfections, 2:9) %>%
mutate(Year = as.numeric(Year)) %>%
group_by(Country) %>%
do(tidy(lm(NewInfections ~ Year, data = .))) %>%
filter(term == "Year") %>%
mutate("p.Interpreted" = ifelse(p.value <= 0.05, "significant", "insignificant"))
new_infections <- read_csv("Epidemic transition metrics_Trend of new HIV infections.csv", col_names = TRUE)
new_infections <- new_infections %>%
filter(Country %in% sub_sahara) %>%
na_if("...") %>%
select(c(1,2,5,8,11,14,17,20,23)) %>%
mutate_at(-1, clean_deaths)
new_infections %>%
na.omit() %>%
gather(Year, NewInfections, 2:9) %>%
ggplot(aes(x = Year, y = NewInfections, color = Country))+
geom_point()+
theme_classic()+
theme(legend.position = "none")+
xlab("Year") + ylab("Number of new infections")
rates_modeled <- new_infections %>%
na.omit() %>%
gather(Year, NewInfections, 2:9) %>%
mutate(Year = as.numeric(Year)) %>%
group_by(Country) %>%
do(tidy(lm(NewInfections ~ Year, data = .))) %>%
filter(term == "Year") %>%
mutate("p.Interpreted" = ifelse(p.value <= 0.05, "significant", "insignificant"))
head(rates_modeled) %>%
kable(format = "html", caption = "Results of linear regression: Rate of new infections per year") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
rates_modeled %>%
na.omit() %>%
ggplot(aes(x = Country, y = estimate, fill = p.Interpreted)) +
geom_col()+
coord_flip()+
theme_bw()+
ylab("Extimated change in HIV infection (people/year)")
ARVs_on_infection <- left_join(arv_dat, rates_modeled, by = "Country")
ARVs_on_infection %>%
na.omit() %>%
ggplot(aes(x = PersCov, y = estimate, shape = p.Interpreted, color = NumberInfected))+
geom_point()+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()+
xlab("% ARV coverage") + ylab("Extimated change in HIV infection (people/year)")
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2,5)) %>%
left_join(arv_dat, by = "Country") %>%
mutate_at(c(2,3), clean_deaths) %>%
na.omit()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = (`2017_Prev` - `2000_Prev`), size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2,5)) %>%
left_join(arv_dat, by = "Country") %>%
mutate_at(c(2,3), clean_deaths) %>%
na.omit()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = (`2017_Prev` - `2000_Prev`), size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
inc_delta_vs_arv <- read_csv("share-of-the-population-infected-with-hiv.csv",
col_names = c("Country", "Code", "Year", "PercPop")) %>%
filter(Country %in% sub_sahara) %>%
select(c(-2)) %>%
left_join(arv_dat, by = "Country") %>%
na.omit()
inc_delta_vs_arv %>%
ggplot(aes(x = PersCov, y = (`2017_Prev` - `2000_Prev`), size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2,5)) %>%
left_join(arv_dat, by = "Country") %>%
mutate_at(c(2,3), clean_deaths) %>%
na.omit()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = (`2017_Prev` - `2000_Prev`), size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
ARVs_on_infection <- left_join(arv_dat, rates_modeled, by = "Country")
ARVs_on_infection %>%
na.omit() %>%
ggplot(aes(x = PersCov, y = estimate, shape = p.Interpreted, color = NumberInfected))+
geom_point()+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()+
xlab("% ARV coverage") + ylab("Extimated change in HIV infection (people/year)")
inc_vs_arv <- read_csv("incidence.csv", col_names = c("Country", "2017_Prev", "2010_Prev", "2005_Prev", "2000_Prev")) %>%
filter(Country %in% sub_sahara) %>%
select(c(1,2,5)) %>%
left_join(arv_dat, by = "Country") %>%
mutate_at(c(2,3), clean_deaths) %>%
na.omit()
inc_vs_arv %>%
ggplot(aes(x = PersCov, y = (`2017_Prev` - `2000_Prev`), size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
inc_delta_vs_arv <- read_csv("share-of-the-population-infected-with-hiv.csv",
col_names = c("Country", "Code", "Year", "PercPop")) %>%
filter(Country %in% sub_sahara) %>%
select(c(-2)) %>%
left_join(arv_dat, by = "Country") %>%
na.omit()
inc_delta_vs_arv %>%
ggplot(aes(x = PersCov, y = (`2017_Prev` - `2000_Prev`), size = NumberInfected, color = NumberOnARV))+
geom_point(alpha = 0.5)+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(maptools)
library(viridis)
library(RColorBrewer)
library(mapproj)
library(broom)
library(ggrepel)
#library(sf)
})
# # load the HIV data
# HIV_rate_2016 <- read_csv("HIV rates.csv", col_names = TRUE, col_types = "cd")
#
# # read in the shape file
#
# africa <-
#   sf::st_read("Africa_SHP/Africa.shp", stringsAsFactors = FALSE, quiet = TRUE) %>%
#   as_tibble() %>%
#   rename(Country = "COUNTRY") %>%
#   left_join(HIV_rate_2016, by = "Country")
#
# africa %>%
#  ggplot() +
#  geom_sf(aes(fill = Rate)) +
#  scale_fill_distiller(palette = "Reds", direction = 1, name = "% HIV infection") +
#  coord_sf() +
#  theme_minimal()
# Read csv with ARV infection dat
arv_dat <- read_csv(
"ARV cov 2017.csv",
col_types = "cccc",
col_names = c("Country", "PersCov", "NumberOnARV", "NumberInfected"),
skip = 1
)
head(arv_dat)
# A list of Sub-Saharan countries
sub_sahara <- readLines("Sub-Saharan.txt")
clean_deaths <- function(x){
# Remove the ranges in brackets and convert the values to integers
x %>%
str_replace_all("\\[.*?\\]", "") %>%
str_replace_all("<", "") %>%
str_replace_all(" ", "") %>%
as.numeric()
}
arv_dat <- arv_dat %>%
filter(Country %in% sub_sahara) %>%
na_if("No data") %>%
mutate_at(2:4, clean_deaths)
head(arv_dat)
arv_dat %>%
top_n(4, wt = NumberInfected) %>%
arrange(-NumberInfected) %>%
kable(format = "html", caption = "Countries with the highest number of HIV infections") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
arv_dat %>%
na.omit(PersCov) %>%
ggplot(aes(x = reorder(Country, PersCov), y = PersCov)) +
geom_point(aes(colour = NumberInfected), size = 3) +
scale_colour_viridis(name = "Number of people infected", trans = "log10") +
coord_flip() +
ylab("% ARV coverage") + xlab("Country") +
theme_bw()
hiv_mort <-
read_csv("HIV deaths.csv", col_types = "ccccc") %>%
na_if("No data") %>%
mutate_at(vars(starts_with("Deaths")), clean_deaths) %>%
filter(Country %in% sub_sahara)
head(hiv_mort)
summary(hiv_mort)
hiv_mort <- hiv_mort %>%
mutate(
min = apply(hiv_mort[, 2:4], 1, FUN = min),
max  = apply(hiv_mort[, 2:4], 1, FUN = max),
Change = max - min
)
hiv_mort %>%
top_n(10, wt = Change) %>%
gather(Year, Deaths, Deaths_2017:Deaths_2000) %>%
na.omit() %>%
mutate(
Year = str_replace(Year, "Deaths_", "") %>% as.numeric()
) %>%
ggplot(aes(x = Year, y = Deaths, color = Country)) +
geom_line() +
geom_vline(xintercept = 2004, color = "black", linetype = "dotted") +
theme_bw() +
theme(legend.position = "bottom")
new_infections <- read_csv("Epidemic transition metrics_Trend of new HIV infections.csv", col_names = TRUE)
new_infections <- new_infections %>%
filter(Country %in% sub_sahara) %>%
na_if("...") %>%
select(c(1,2,5,8,11,14,17,20,23)) %>%
mutate_at(-1, clean_deaths)
new_infections %>%
na.omit() %>%
gather(Year, NewInfections, 2:9) %>%
ggplot(aes(x = Year, y = NewInfections, color = Country))+
geom_point()+
theme_classic()+
theme(legend.position = "none")+
xlab("Year") + ylab("Number of new infections")
rates_modeled <- new_infections %>%
na.omit() %>%
gather(Year, NewInfections, 2:9) %>%
mutate(Year = as.numeric(Year)) %>%
group_by(Country) %>%
do(tidy(lm(NewInfections ~ Year, data = .))) %>%
filter(term == "Year") %>%
mutate("p.Interpreted" = ifelse(p.value <= 0.05, "significant", "insignificant"))
head(rates_modeled) %>%
kable(format = "html", caption = "Results of linear regression: Rate of new infections per year") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
rates_modeled %>%
na.omit() %>%
ggplot(aes(x = Country, y = estimate, fill = p.Interpreted)) +
geom_col()+
coord_flip()+
theme_bw()+
ylab("Extimated change in HIV infection (people/year)")
ARVs_on_infection <- left_join(arv_dat, rates_modeled, by = "Country")
ARVs_on_infection %>%
na.omit() %>%
ggplot(aes(x = PersCov, y = estimate, shape = p.Interpreted, color = NumberInfected))+
geom_point()+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()+
xlab("% ARV coverage") + ylab("Extimated change in HIV infection (people/year)")
knitr::opts_chunk$set(echo = TRUE)
