ARV_cov.df %>%
na.omit(PersCov) %>%
ggplot(aes(x = reorder(Country, PersCov), y = PersCov, fill = log10(NumberInfected)))+
scale_fill_viridis(name = "Log10 number infected")+
geom_col()+
coord_flip()+
ylab("% ARV coverage") + xlab("Country")+
theme_bw()
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(maptools)
library(RColorBrewer)
ARV_cov.df <- read_csv("ARV cov 2017.csv", col_names = TRUE)
# A list of Sub-Saharan countries
ssa.list <- (read_csv("Sub-Saharan.txt", col_names = FALSE)[["X1"]])
head(ARV_cov.df)
# rename the variables
colnames(ARV_cov.df) <- c("Country", "PersCov", "NumberOnARV", "NumberInfected")
# Remove the ranges in brackets and convert the values to intigers
ARV_cov.df <- ARV_cov.df %>%
na_if("No data") %>%
mutate(PersCov = str_replace_all(PersCov, "\\[.*?\\]", ""),
NumberInfected = str_replace_all(NumberInfected, "\\[.*?\\]", ""),
NumberInfected = str_replace_all(NumberInfected, "<", ""),
NumberInfected = str_replace_all(NumberInfected, " ", ""),
PersCov = as.double(PersCov),
NumberOnARV = as.double(NumberOnARV),
NumberInfected = as.double(NumberInfected))
# select only the countries we need
ARV_cov.df <- ARV_cov.df[ARV_cov.df$Country %in% ssa.list, ]
head(ARV_cov.df)
ARV_cov.df %>%
na.omit(PersCov) %>%
ggplot(aes(x = reorder(Country, PersCov), y = PersCov, fill = log10(NumberInfected)))+
scale_fill_viridis(name = "Log10 number infected")+
geom_col()+
coord_flip()+
ylab("% ARV coverage") + xlab("Country")+
theme_bw()
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(maptools)
library(RColorBrewer)
ARV_cov.df <- read_csv("ARV cov 2017.csv", col_names = TRUE)
# A list of Sub-Saharan countries
ssa.list <- (read_csv("Sub-Saharan.txt", col_names = FALSE)[["X1"]])
head(ARV_cov.df)
# rename the variables
colnames(ARV_cov.df) <- c("Country", "PersCov", "NumberOnARV", "NumberInfected")
# Remove the ranges in brackets and convert the values to intigers
ARV_cov.df <- ARV_cov.df %>%
na_if("No data") %>%
mutate(PersCov = str_replace_all(PersCov, "\\[.*?\\]", ""),
NumberInfected = str_replace_all(NumberInfected, "\\[.*?\\]", ""),
NumberInfected = str_replace_all(NumberInfected, "<", ""),
NumberInfected = str_replace_all(NumberInfected, " ", ""),
PersCov = as.double(PersCov),
NumberOnARV = as.double(NumberOnARV),
NumberInfected = as.double(NumberInfected))
# select only the countries we need
ARV_cov.df <- ARV_cov.df[ARV_cov.df$Country %in% ssa.list, ]
head(ARV_cov.df)
ARV_cov.df %>%
na.omit(PersCov) %>%
ggplot(aes(x = reorder(Country, PersCov), y = PersCov, fill = log10(NumberInfected)))+
scale_fill_viridis(name = "Log10 number infected")+
geom_col()+
coord_flip()+
ylab("% ARV coverage") + xlab("Country")+
theme_bw()
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(maptools)
library(RColorBrewer)
ARV_cov.df <- read_csv("ARV cov 2017.csv", col_names = TRUE)
# A list of Sub-Saharan countries
ssa.list <- (read_csv("Sub-Saharan.txt", col_names = FALSE)[["X1"]])
head(ARV_cov.df)
# rename the variables
colnames(ARV_cov.df) <- c("Country", "PersCov", "NumberOnARV", "NumberInfected")
# Remove the ranges in brackets and convert the values to intigers
ARV_cov.df <- ARV_cov.df %>%
na_if("No data") %>%
mutate(PersCov = str_replace_all(PersCov, "\\[.*?\\]", ""),
NumberInfected = str_replace_all(NumberInfected, "\\[.*?\\]", ""),
NumberInfected = str_replace_all(NumberInfected, "<", ""),
NumberInfected = str_replace_all(NumberInfected, " ", ""),
PersCov = as.double(PersCov),
NumberOnARV = as.double(NumberOnARV),
NumberInfected = as.double(NumberInfected))
# select only the countries we need
ARV_cov.df <- ARV_cov.df[ARV_cov.df$Country %in% ssa.list, ]
head(ARV_cov.df)
ARV_cov.df %>%
na.omit(PersCov) %>%
ggplot(aes(x = reorder(Country, PersCov), y = PersCov, fill = log10(NumberInfected)))+
scale_fill_viridis(name = "Log10 number infected")+
geom_col()+
coord_flip()+
ylab("% ARV coverage") + xlab("Country")+
theme_bw()
library(viridis)
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(maptools)
library(viridis)
library(RColorBrewer)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(maptools)
library(viridis)
library(RColorBrewer)
ARV_cov.df <- read_csv("ARV cov 2017.csv", col_names = TRUE)
# A list of Sub-Saharan countries
ssa.list <- (read_csv("Sub-Saharan.txt", col_names = FALSE)[["X1"]])
head(ARV_cov.df)
# rename the variables
colnames(ARV_cov.df) <- c("Country", "PersCov", "NumberOnARV", "NumberInfected")
# Remove the ranges in brackets and convert the values to intigers
ARV_cov.df <- ARV_cov.df %>%
na_if("No data") %>%
mutate(PersCov = str_replace_all(PersCov, "\\[.*?\\]", ""),
NumberInfected = str_replace_all(NumberInfected, "\\[.*?\\]", ""),
NumberInfected = str_replace_all(NumberInfected, "<", ""),
NumberInfected = str_replace_all(NumberInfected, " ", ""),
PersCov = as.double(PersCov),
NumberOnARV = as.double(NumberOnARV),
NumberInfected = as.double(NumberInfected))
# select only the countries we need
ARV_cov.df <- ARV_cov.df[ARV_cov.df$Country %in% ssa.list, ]
head(ARV_cov.df)
ARV_cov.df %>%
na.omit(PersCov) %>%
ggplot(aes(x = reorder(Country, PersCov), y = PersCov, fill = log10(NumberInfected)))+
scale_fill_viridis(name = "Log10 number infected")+
geom_col()+
coord_flip()+
ylab("% ARV coverage") + xlab("Country")+
theme_bw()
ARV_cov.df %>%
filter(NumberInfected >= max(ARV_cov.df$NumberInfected, na.rm = TRUE)) %>%
kable(format = "html", caption = "Country with the highest HIV infection") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
HIV_mort <- read_csv("HIV deaths.csv", col_names = TRUE)
head(HIV_mort)
# Remove the ranges in brackets and convert the values to intigers
HIV_mort <- HIV_mort %>%
na_if("No data") %>%
mutate(Deaths_2017 = str_replace_all(Deaths_2017, "\\[.*?\\]", ""),
Deaths_2010 = str_replace_all(Deaths_2010, "\\[.*?\\]", ""),
Deaths_2005 = str_replace_all(Deaths_2005, "\\[.*?\\]", ""),
Deaths_2000 = str_replace_all(Deaths_2000, "\\[.*?\\]", ""),
Deaths_2017 = str_replace_all(Deaths_2017, "<", ""),
Deaths_2010 = str_replace_all(Deaths_2010, "<", ""),
Deaths_2005 = str_replace_all(Deaths_2005, "<", ""),
Deaths_2000 = str_replace_all(Deaths_2000, "<", ""),
Deaths_2017 = str_replace_all(Deaths_2017, " ", ""),
Deaths_2010 = str_replace_all(Deaths_2010, " ", ""),
Deaths_2005 = str_replace_all(Deaths_2005, " ", ""),
Deaths_2000 = str_replace_all(Deaths_2000, " ", ""),
Deaths_2017 = as.double(Deaths_2017),
Deaths_2010 = as.double(Deaths_2010),
Deaths_2005 = as.double(Deaths_2005),
Deaths_2000 = as.double(Deaths_2000))
# select only the countries we need
HIV_mort <- HIV_mort[HIV_mort$Country %in% ssa.list, ]
head(HIV_mort)
summary(HIV_mort)
HIV_mort <- HIV_mort %>%
mutate(min = apply(HIV_mort[, 2:4], 1, FUN = min)) %>%
mutate(max  = apply(HIV_mort[, 2:4], 1, FUN = max)) %>%
mutate(Change = max - min)
HIV_mort %>%
top_n(10, wt = Change) %>%
gather(Year, Deaths, Deaths_2017:Deaths_2000) %>%
na.omit() %>%
separate(Year, c("D", "Year"), sep = "_", convert = TRUE) %>% # I should be able to use NA rather than D, but get an error
ggplot(aes(x = Year, y = Deaths, color = Country))+
geom_line()+
geom_vline(xintercept = 2004, color = "black", linetype  = "dotted")+
theme_bw()+
theme(legend.position = "bottom")
# load the HIV data
HIV_rate_2016 <- read_csv("HIV rates.csv", col_names = TRUE)
#read in the shape file
africa <- readShapeSpatial("Africa_SHP/Africa.shp") %>%
fortify(africa.shp, region = "COUNTRY") %>%
merge(HIV_rate_2016, by.x = "id", by.y = "Country", all.x=TRUE) %>%
arrange(order)
africa %>%
ggplot()+
geom_polygon(aes(x = long, y = lat, group = group, fill = Rate),
color = "black", size = 0.2)+
coord_map()+
scale_fill_distiller(palette = "Greens", direction = 1, name = "% HIV infection rate") +
theme(panel.background = element_blank(), axis.text = element_blank(),
axis.title = element_blank(), axis.ticks = element_blank())
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(maptools)
library(viridis)
library(RColorBrewer)
library(mapproj)
library(broom)
library(ggrepel)
library(sf)
})
# load the HIV data
HIV_rate_2016 <- read_csv("HIV rates.csv", col_names = TRUE, col_types = "cd")
# read in the shape file
africa <-
sf::st_read("Africa_SHP/Africa.shp", stringsAsFactors = FALSE, quiet = TRUE) %>%
as_tibble() %>%
rename(Country = "COUNTRY") %>%
left_join(HIV_rate_2016, by = "Country")
africa %>%
ggplot() +
geom_sf(aes(fill = Rate)) +
scale_fill_distiller(palette = "Reds", direction = 1, name = "% HIV infection rate") +
coord_sf() +
theme_minimal()
# Read csv with ARV infection dat
arv_dat <- read_csv(
"ARV cov 2017.csv",
col_types = "cccc",
col_names = c("Country", "PersCov", "NumberOnARV", "NumberInfected"),
skip = 1
)
head(arv_dat)
# A list of Sub-Saharan countries
sub_sahara <- readLines("Sub-Saharan.txt")
clean_deaths <- function(x){
# Remove the ranges in brackets and convert the values to integers
x %>%
str_replace_all("\\[.*?\\]", "") %>%
str_replace_all("<", "") %>%
str_replace_all(" ", "") %>%
as.numeric()
}
arv_dat <- arv_dat %>%
filter(Country %in% sub_sahara) %>%
na_if("No data") %>%
mutate_at(2:4, clean_deaths)
head(arv_dat)
arv_dat %>%
top_n(4, wt = NumberInfected) %>%
arrange(-NumberInfected) %>%
kable(format = "html", caption = "Countries with the highest number of HIV infection") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
arv_dat %>%
na.omit(PersCov) %>%
ggplot(aes(x = reorder(Country, PersCov), y = PersCov)) +
geom_point(aes(colour = NumberInfected), size = 3) +
scale_colour_viridis(name = "Number of people infected", trans = "log10") +
coord_flip() +
ylab("% ARV coverage") + xlab("Country") +
theme_bw()
hiv_mort <-
read_csv("HIV deaths.csv", col_types = "ccccc") %>%
na_if("No data") %>%
mutate_at(vars(starts_with("Deaths")), clean_deaths) %>%
filter(Country %in% sub_sahara)
head(hiv_mort)
summary(hiv_mort)
hiv_mort <- hiv_mort %>%
mutate(
min = apply(hiv_mort[, 2:4], 1, FUN = min),
max  = apply(hiv_mort[, 2:4], 1, FUN = max),
Change = max - min
)
hiv_mort %>%
top_n(10, wt = Change) %>%
gather(Year, Deaths, Deaths_2017:Deaths_2000) %>%
na.omit() %>%
mutate(
Year = str_replace(Year, "Deaths_", "") %>% as.numeric()
) %>%
ggplot(aes(x = Year, y = Deaths, color = Country)) +
geom_line() +
geom_vline(xintercept = 2004, color = "black", linetype = "dotted") +
theme_bw() +
theme(legend.position = "bottom")
new_infections <- read_csv("Epidemic transition metrics_Trend of new HIV infections.csv", col_names = TRUE)
new_infections <- new_infections %>%
filter(Country %in% sub_sahara) %>%
na_if("No data") %>%
select(c(1,2,5,8,11,14,17,20,23)) %>%
mutate_at(-1, clean_deaths)
new_infections %>%
na.omit() %>%
gather(Year, NewInfections, 2:9) %>%
ggplot(aes(x = Year, y = NewInfections, color = Country))+
geom_point()+
theme_classic()+
theme(legend.position = "none")+
xlab("Year") + ylab("Number of new infections")
rates_modeled <- new_infections %>%
na.omit() %>%
gather(Year, NewInfections, 2:9) %>%
mutate(Year = as.numeric(Year)) %>%
group_by(Country) %>%
do(tidy(lm(NewInfections ~ Year, data = .))) %>%
filter(term == "Year") %>%
mutate("p.Interpreted" = ifelse(p.value <= 0.05, "significant", "insignificant"))
head(rates_modeled) %>%
kable(format = "html", caption = "Results of linear regression: Rate of new infections per year") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
rates_modeled %>%
na.omit() %>%
ggplot(aes(x = Country, y = estimate, fill = p.Interpreted)) +
geom_col()+
coord_flip()+
theme_bw()+
ylab("Extimated change in HIV infection (people/year)")
ARVs_on_infection <- left_join(arv_dat, rates_modeled, by = "Country")
ARVs_on_infection %>%
na.omit() %>%
ggplot(aes(x = PersCov, y = estimate, shape = p.Interpreted, color = NumberInfected))+
geom_point()+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()+
xlab("% ARV coverage") + ylab("Extimated change in HIV infection (people/year)")
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
library(maptools)
library(viridis)
library(RColorBrewer)
library(mapproj)
library(broom)
library(ggrepel)
library(sf)
})
# load the HIV data
HIV_rate_2016 <- read_csv("HIV rates.csv", col_names = TRUE, col_types = "cd")
# read in the shape file
africa <-
sf::st_read("Africa_SHP/Africa.shp", stringsAsFactors = FALSE, quiet = TRUE) %>%
as_tibble() %>%
rename(Country = "COUNTRY") %>%
left_join(HIV_rate_2016, by = "Country")
africa %>%
ggplot() +
geom_sf(aes(fill = Rate)) +
scale_fill_distiller(palette = "Reds", direction = 1, name = "% HIV infection rate") +
coord_sf() +
theme_minimal()
# Read csv with ARV infection dat
arv_dat <- read_csv(
"ARV cov 2017.csv",
col_types = "cccc",
col_names = c("Country", "PersCov", "NumberOnARV", "NumberInfected"),
skip = 1
)
head(arv_dat)
# A list of Sub-Saharan countries
sub_sahara <- readLines("Sub-Saharan.txt")
clean_deaths <- function(x){
# Remove the ranges in brackets and convert the values to integers
x %>%
str_replace_all("\\[.*?\\]", "") %>%
str_replace_all("<", "") %>%
str_replace_all(" ", "") %>%
as.numeric()
}
arv_dat <- arv_dat %>%
filter(Country %in% sub_sahara) %>%
na_if("No data") %>%
mutate_at(2:4, clean_deaths)
head(arv_dat)
arv_dat %>%
top_n(4, wt = NumberInfected) %>%
arrange(-NumberInfected) %>%
kable(format = "html", caption = "Countries with the highest number of HIV infection") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
arv_dat %>%
na.omit(PersCov) %>%
ggplot(aes(x = reorder(Country, PersCov), y = PersCov)) +
geom_point(aes(colour = NumberInfected), size = 3) +
scale_colour_viridis(name = "Number of people infected", trans = "log10") +
coord_flip() +
ylab("% ARV coverage") + xlab("Country") +
theme_bw()
hiv_mort <-
read_csv("HIV deaths.csv", col_types = "ccccc") %>%
na_if("No data") %>%
mutate_at(vars(starts_with("Deaths")), clean_deaths) %>%
filter(Country %in% sub_sahara)
head(hiv_mort)
summary(hiv_mort)
hiv_mort <- hiv_mort %>%
mutate(
min = apply(hiv_mort[, 2:4], 1, FUN = min),
max  = apply(hiv_mort[, 2:4], 1, FUN = max),
Change = max - min
)
hiv_mort %>%
top_n(10, wt = Change) %>%
gather(Year, Deaths, Deaths_2017:Deaths_2000) %>%
na.omit() %>%
mutate(
Year = str_replace(Year, "Deaths_", "") %>% as.numeric()
) %>%
ggplot(aes(x = Year, y = Deaths, color = Country)) +
geom_line() +
geom_vline(xintercept = 2004, color = "black", linetype = "dotted") +
theme_bw() +
theme(legend.position = "bottom")
new_infections <- read_csv("Epidemic transition metrics_Trend of new HIV infections.csv", col_names = TRUE)
new_infections <- new_infections %>%
filter(Country %in% sub_sahara) %>%
na_if("...") %>%
select(c(1,2,5,8,11,14,17,20,23)) %>%
mutate_at(-1, clean_deaths)
new_infections %>%
na.omit() %>%
gather(Year, NewInfections, 2:9) %>%
ggplot(aes(x = Year, y = NewInfections, color = Country))+
geom_point()+
theme_classic()+
theme(legend.position = "none")+
xlab("Year") + ylab("Number of new infections")
rates_modeled <- new_infections %>%
na.omit() %>%
gather(Year, NewInfections, 2:9) %>%
mutate(Year = as.numeric(Year)) %>%
group_by(Country) %>%
do(tidy(lm(NewInfections ~ Year, data = .))) %>%
filter(term == "Year") %>%
mutate("p.Interpreted" = ifelse(p.value <= 0.05, "significant", "insignificant"))
head(rates_modeled) %>%
kable(format = "html", caption = "Results of linear regression: Rate of new infections per year") %>%
kable_styling(bootstrap_options = c("striped", "hover"))
rates_modeled %>%
na.omit() %>%
ggplot(aes(x = Country, y = estimate, fill = p.Interpreted)) +
geom_col()+
coord_flip()+
theme_bw()+
ylab("Extimated change in HIV infection (people/year)")
ARVs_on_infection <- left_join(arv_dat, rates_modeled, by = "Country")
ARVs_on_infection %>%
na.omit() %>%
ggplot(aes(x = PersCov, y = estimate, shape = p.Interpreted, color = NumberInfected))+
geom_point()+
geom_text_repel(aes(label = Country), size = 3)+
theme_bw()+
xlab("% ARV coverage") + ylab("Extimated change in HIV infection (people/year)")
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(dplyr)
library(readr)
library(stringr)
library(tidyr)
library(ggplot2)
library(knitr)
library(kableExtra)
})
nrti_dr_scores <- read_delim("ScoresNRTI_1555579653110.tsv", col_names = TRUE,
delim = "\t", col_types = "cdcddddddd")
nrti_dr_scores %>%
select(-c(2,3,6,7)) %>%
gather(arv, score, 2:6) %>%
filter(!grepl(" ",Rule)) %>%
mutate(effect = ifelse(score > 0, "resistance", "hyperSusept")) %>%
ggplot(aes(x = Rule, y = score, fill = effect))+
geom_col()+
coord_flip()+
theme_bw()+
facet_grid(. ~ arv)
